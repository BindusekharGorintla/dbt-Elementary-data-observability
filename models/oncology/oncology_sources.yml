version: 2

sources:

  - name: oncology_databricks
    catalog: "{{ var('oncology_src_catalog')}}"
    schema: "{{ var('oncology_src_schema')}}"
    tables:
      - name: member
        config: 
          tags: ["oncology"]
        columns:
        - name: pat_id
          description: "pat_id"
          tests:
            - duplicates_check
        - name: date_of_birth
          description: "date_of_birth"
          tests:
            - Column_date_value_not_null
            - comparison_min_max_dates
            - comparison_completion_rates_distinct_cnts
            - duplicates_check
        - name: tumour
          description: "tumour"
          tests:
            - column_values_to_not_be_in_set: {'input_value' : No Data Row}
        - name: drug
          description: "drug"
          tests:
            - duplicates_check
        - name: patient_rx
          description: "patient_rx"
          tests:
            - duplicates_check
        - name: ethnicity
          description: "ethnicity"
          tests:
            - column_values_to_not_be_in_set: {'input_value' : No Data Row}
            - duplicates_check
            
 
